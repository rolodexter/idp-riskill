<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles-additions.css">
    <link rel="stylesheet" href="styles-refined.css">
    <link rel="stylesheet" href="styles-refined-layout.css">
    <link rel="stylesheet" href="module-row-fix.css">
    <link rel="stylesheet" href="anomalies-widget.css">
    <link rel="stylesheet" href="src/components/projects/projects-widget.css">
    <link rel="stylesheet" href="src/components/widget-tray/widget-tray.css">
    <title>Riskill Dashboard</title>
    <script src="https://unpkg.com/react/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>
    <!-- Enhanced Anomalies Widget Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6.9/dist/plot.umd.min.js"></script>
    <script>
        window.Plot = Plot;
    </script>
    <script src="https://unpkg.com/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.7/dist/tippy-bundle.umd.js"></script>
    <script>
        window.tippy = tippy;
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script>
        window.Sortable = Sortable;
    </script>
    <script src="https://unpkg.com/@floating-ui/dom@1.5.1/dist/floating-ui.dom.umd.min.js"></script>
    <!-- Advanced data visualization styles -->
    <!-- Enhanced Typography with Professional Font Pairing -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Manrope:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Added ApexCharts for professional data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>
<body>
    <div class="app-container">
        <!-- Top ERP-style menu with glassmorphism -->
        <nav class="top-menu">
            <button class="hamburger" id="hamburger-menu" aria-label="Open Menu">
                <span class="menu-line"></span>
                <span class="menu-line"></span>
                <span class="menu-line"></span>
            </button>
            <div class="menu-group">
                <div class="menu-item"><span>File</span></div>
                <div class="menu-item"><span>Edit</span></div>
                <div class="menu-item"><span>View</span></div>
                <div class="menu-item"><span>Agents</span></div>
                <div class="menu-item"><span>Data</span></div>
                <div class="menu-item"><span>Settings</span></div>
            </div>
            <div class="user-info">
                <span class="user-name">Matthias</span>
                <div class="user-avatar">M</div>
            </div>
        </nav>
        <div id="mobile-menu-overlay" class="mobile-menu-overlay">
            <div class="mobile-menu-content">
                <button class="close-mobile-menu" aria-label="Close Menu">&times;</button>
                <div class="mobile-menu-item">File</div>
                <div class="mobile-menu-item">Edit</div>
                <div class="mobile-menu-item">View</div>
                <div class="mobile-menu-item">Agents</div>
                <div class="mobile-menu-item">Data</div>
                <div class="mobile-menu-item">Settings</div>
            </div>
        </div>

        <!-- KPI Widget Row -->
        <section class="kpi-row">
            <!-- Widget 1: Revenue Widget -->
            <div class="kpi-widget" id="revenue-widget">
                <div class="widget-title">Revenue</div>
                <div class="kpi-value">11.3T</div>
                <div class="kpi-label">Total Revenue (pesos)</div>
                <div class="kpi-sparkline"></div>
            </div>

            <!-- Widget 2: Business Unit Widget -->
            <div class="kpi-widget" id="business-unit-widget">
                <div class="widget-title">Business Units</div>
                <div class="kpi-value">Z001</div>
                <div class="kpi-label">Top Performing Unit</div>
                <div class="kpi-sparkline"></div>
            </div>

            <!-- Widget 3: Projects Widget -->
            <div class="kpi-widget projects-widget enterprise-kpi" id="projects-widget">
                <div class="widget-title">Projects</div>
                <!-- Widget content will be generated by ProjectWidget class -->
            </div>

            <!-- Widget 4: Customer Widget -->
            <div class="kpi-widget" id="customer-widget">
                <div class="widget-title">Customers</div>
                <div class="kpi-value">881</div>
                <div class="kpi-label">Active Accounts</div>
                <div class="kpi-sparkline"></div>
            </div>

            <!-- Widget 5: Data Quality Widget -->
            <div class="kpi-widget" id="data-widget">
                <div class="widget-title">Data Quality</div>
                <div class="kpi-value">94%</div>
                <div class="kpi-label">Reliability Score</div>
                <div class="kpi-sparkline"></div>
            </div>
        </section>

        <!-- Dashboard Layout with Sidebar, Main Content, and Right Zone -->
        <div class="dashboard-layout">
            <!-- Left Sidebar -->
            <aside class="left-sidebar">
                <!-- AI Assistant Widget -->
                <div class="placeholder-widget ai-assistant">
                    <div class="placeholder-header">AI Assistant</div>
                    <div class="placeholder-content">
                        <div class="ai-assistant-profile">
                            <div class="assistant-avatar">
                                <i class="ph ph-robot"></i>
                            </div>
                            <div class="assistant-info">
                                <div class="assistant-name">Eduardo</div>
                                <div class="assistant-status online">Active</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Riskill Agents Widget -->
                <div class="placeholder-widget">
                    <div class="placeholder-header">Riskill Agents</div>
                    <div class="placeholder-content">
                        <div class="agent-item">
                            <i class="ph ph-robot"></i>
                            <span>Risk Assessment Agent</span>
                        </div>
                        <div class="agent-item">
                            <i class="ph ph-robot"></i>
                            <span>Vendor Analysis Agent</span>
                        </div>
                        <div class="agent-item">
                            <i class="ph ph-robot"></i>
                            <span>Deal Intelligence Agent</span>
                        </div>
                    </div>
                </div>

                <!-- Data Sources Widget -->
                <div class="placeholder-widget">
                    <div class="placeholder-header">Data Sources</div>
                    <div class="placeholder-content">
                        <div class="source-item" id="erp-source">
                            <i class="ph ph-database"></i>
                            <span>Enterprise ERP</span>
                        </div>
                        <div class="source-item" id="vendor-source">
                            <i class="ph ph-database"></i>
                            <span>Vendor Database</span>
                        </div>
                        <div class="source-item" id="market-source">
                            <i class="ph ph-database"></i>
                            <span>Market Intelligence</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="main-content">
                <!-- IDP Maritime Intelligence Analysis Header -->
                <div class="main-content-header">
                    <h2>IDP Maritime Intelligence Analysis</h2>
                </div>

                <!-- Automation Opportunity Analysis Section -->
                <div class="placeholder-widget">
                    <div class="placeholder-header">
                        <i class="ph ph-target"></i>
                        Automation Opportunity Analysis
                    </div>
                    <div class="analysis-content">
                        <div class="challenges-column">
                            <h3>Current Challenges</h3>
                            <ul class="challenge-list">
                                <li><i class="ph ph-warning-circle"></i> 67% missing dates</li>
                                <li><i class="ph ph-warning-circle"></i> 840B+ peso unlinked</li>
                                <li><i class="ph ph-warning-circle"></i> Manual workflows</li>
                                <li><i class="ph ph-warning-circle"></i> Multi-entity gaps</li>
                            </ul>
                        </div>
                        <div class="solutions-column">
                            <h3>AI-Powered Solutions</h3>
                            <ul class="solution-list">
                                <li><i class="ph ph-check-circle"></i> Automated date inference</li>
                                <li><i class="ph ph-check-circle"></i> Intelligent transaction linking</li>
                                <li><i class="ph ph-check-circle"></i> Predictive workflow</li>
                                <li><i class="ph ph-check-circle"></i> Real-time insights</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Competitive Advantage Transformation Section -->
                <div class="placeholder-widget">
                    <div class="placeholder-header">
                        <i class="ph ph-rocket"></i>
                        Competitive Advantage Transformation
                    </div>
                    <div class="placeholder-content">
                        <p class="transformation-narrative">
                            Transform IDP's data quality challenges into automation-powered competitive advantages
                            through AI-driven maritime intelligence workflows and predictive analytics.
                        </p>
                        <div class="transformation-metrics">
                            <div class="metric">
                                <span class="metric-value">67%</span>
                                <span class="metric-label">Data Recovery</span>
                            </div>
                            <div class="metric">
                                <span class="metric-value">840B</span>
                                <span class="metric-label">Peso Recovery</span>
                            </div>
                            <div class="metric">
                                <span class="metric-value">47%</span>
                                <span class="metric-label">Efficiency Gain</span>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Right Zone -->
            <aside class="right-zone">
                <!-- Anomalies Widget -->
                <div class="placeholder-widget">
                    <div class="placeholder-header">Anomalies</div>
                    <div class="placeholder-content">
                        <div class="anomaly-item">
                            <div class="anomaly-indicator warning"></div>
                            <span>Missing transaction dates (7)</span>
                            <small>Aug 1-3, 2025 • High Impact</small>
                        </div>
                        <div class="anomaly-item">
                            <div class="anomaly-indicator error"></div>
                            <span>New international supplier</span>
                            <small>No prior relationship • $142,800</small>
                        </div>
                        <div class="anomaly-item">
                            <div class="anomaly-indicator info"></div>
                            <span>Customer segment shift</span>
                            <small>Gov sector +28% vs. forecast</small>
                        </div>
                        <div class="anomaly-item">
                            <div class="anomaly-indicator error"></div>
                            <span>Product pricing irregularity</span>
                            <small>U001 pricing variance detected</small>
                        </div>
                    </div>
                </div>

                <!-- Opportunities Widget -->
                <div class="placeholder-widget">
                    <div class="placeholder-header">Opportunities</div>
                    <div class="placeholder-content">
                        <div class="opportunity-item">
                            <i class="ph ph-lightbulb"></i>
                            <span>Cross-selling potential with Gov sector clients</span>
                        </div>
                        <div class="opportunity-item">
                            <i class="ph ph-lightbulb"></i>
                            <span>Vendor consolidation could save 12.7%</span>
                        </div>
                        <div class="opportunity-item">
                            <i class="ph ph-lightbulb"></i>
                            <span>Predictive maintenance savings: 3.2M</span>
                        </div>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Module Row - Maritime Intelligence Modules -->
        <div class="module-row">
            <!-- Risk Engine Module -->
            <div class="module-item">
                <div class="module-icon">
                    <i class="ph ph-warning"></i>
                </div>
                <div class="module-name">RISK ENGINE</div>
                <div class="module-description">Risk Management Algorithms</div>
            </div>

            <!-- Portfolio Analytics Module -->
            <div class="module-item">
                <div class="module-icon">
                    <i class="ph ph-chart-bar"></i>
                </div>
                <div class="module-name">PORTFOLIO ANALYTICS</div>
                <div class="module-description">Analytics Tools</div>
            </div>

            <!-- Market Intelligence Module -->
            <div class="module-item">
                <div class="module-icon">
                    <i class="ph ph-trend-up"></i>
                </div>
                <div class="module-name">MARKET INTELLIGENCE</div>
                <div class="module-description">Market Intelligence</div>
            </div>

            <!-- Operational Metrics Module -->
            <div class="module-item">
                <div class="module-icon">
                    <i class="ph ph-activity"></i>
                </div>
                <div class="module-name">OPERATIONAL METRICS</div>
                <div class="module-description">Activity Monitoring</div>
            </div>

            <!-- Maritime Routes Module -->
            <div class="module-item">
                <div class="module-icon">
                    <i class="ph ph-map-pin"></i>
                </div>
                <div class="module-name">MARITIME ROUTES</div>
                <div class="module-description">Routes Planning</div>
            </div>

            <!-- Fleet Management Module -->
            <div class="module-item">
                <div class="module-icon">
                    <i class="ph ph-boat"></i>
                </div>
                <div class="module-name">FLEET MANAGEMENT</div>
                <div class="module-description">Real-time tracking</div>
            </div>
        </div>
    </div>

    <!-- Include data visualizations scripts -->
    <script src="data-visualizations.js"></script>
    <script src="refined-visualizations.js"></script>
    <script src="src/components/projects/projects-widget.js"></script>
    <script src="src/components/widget-tray/widget-tray.js"></script>
    <script src="product-category-visualization.js"></script>

    <!-- SQL Modal -->
    <div class="modal-overlay" id="sql-modal-overlay">
        <div class="sql-modal">
            <div class="sql-modal-header">
                <div class="sql-modal-title">
                    <i class="ph ph-database"></i>
                    <span>SQL Server Management Studio</span>
                </div>
                <button class="sql-modal-close" id="sql-modal-close">
                    <i class="ph ph-x"></i>
                </button>
            </div>
            <div class="sql-modal-body">
                <div class="sql-sidebar">
                    <ul class="sql-table-list">
                        <li class="sql-table-item active" data-table="transactions">
                            <i class="ph ph-table"></i>
                            <span>transactions</span>
                        </li>
                        <li class="sql-table-item" data-table="vendors">
                            <i class="ph ph-table"></i>
                            <span>vendors</span>
                        </li>
                        <li class="sql-table-item" data-table="contracts">
                            <i class="ph ph-table"></i>
                            <span>contracts</span>
                        </li>
                    </ul>
                </div>
                <div class="sql-table-content" id="sql-table-content">
                    <!-- Table content will be loaded dynamically -->
                </div>
            </div>
            <div class="sql-footer">
                <div class="sql-status">Connected to: Enterprise ERP Database</div>
                <div class="sql-actions">
                    <button class="sql-button">Export</button>
                    <button class="sql-button primary">Run Query</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reset Demo Button -->
    <button class="reset-demo" id="reset-demo">
        <i class="ph ph-arrows-clockwise"></i>
        Reset Demo
    </button>

    <script src="scripts.js" type="module"></script>
    <script>
        // Table data
        const tableData = {
            transactions: {
                title: 'Transactions',
                description: 'Maritime transaction records with vessel, cargo, and financial details',
                columns: ['transaction_id', 'date', 'vessel_id', 'cargo_type', 'amount', 'currency', 'status'],
                rows: [
                    ['TRX-7842', '2025-07-28', 'VSL-001', 'Container', '156,000', 'PESO', 'Completed'],
                    ['TRX-7843', '2025-07-29', 'VSL-002', 'Bulk', '92,500', 'PESO', 'Pending'],
                    ['TRX-7844', '2025-07-30', 'VSL-003', 'Container', '210,000', 'PESO', 'Completed'],
                    ['TRX-7845', '2025-07-31', 'VSL-001', 'Container', '178,000', 'PESO', 'Processing'],
                    ['TRX-7846', '2025-08-01', 'VSL-004', 'Liquid', '320,000', 'PESO', 'Completed']
                ]
            },
            vendors: {
                title: 'Vendors',
                description: 'Supplier and service provider information for maritime operations',
                columns: ['vendor_id', 'name', 'category', 'risk_score', 'contract_value', 'status'],
                rows: [
                    ['VND-001', 'Acme Corp', 'Equipment', '72', '1.2M', 'Active'],
                    ['VND-002', 'Maritime Supplies Ltd', 'Consumables', '85', '840K', 'Active'],
                    ['VND-003', 'Global Shipping Co', 'Logistics', '64', '2.1M', 'Under Review'],
                    ['VND-004', 'Tech Marine Systems', 'Technology', '91', '950K', 'Active'],
                    ['VND-005', 'Oceanic Maintenance', 'Services', '78', '1.5M', 'Active']
                ]
            },
            contracts: {
                title: 'Contracts',
                description: 'Legal agreements with vendors, partners, and clients',
                columns: ['contract_id', 'title', 'party', 'start_date', 'end_date', 'value', 'status'],
                rows: [
                    ['CNT-001', 'Equipment Supply', 'Acme Corp', '2025-01-15', '2025-12-31', '1.2M', 'Active'],
                    ['CNT-002', 'Route Partnership', 'Global Shipping', '2025-03-01', '2026-02-28', '2.1M', 'Active'],
                    ['CNT-003', 'Gov Contract 881', 'Gov Agency', '2025-06-15', '2025-12-15', '4.7M', 'Active'],
                    ['CNT-004', 'Tech Implementation', 'Tech Marine', '2025-04-10', '2025-10-10', '950K', 'Active'],
                    ['CNT-005', 'Maintenance Service', 'Oceanic', '2025-02-01', '2026-01-31', '1.5M', 'Active']
                ]
            }
        };

        // Function to render table content
        function renderTable(tableId) {
            const tableInfo = tableData[tableId];
            const content = document.getElementById('sql-table-content');

            let html = `
                <div class="sql-table-header">
                    <h3>${tableInfo.title}</h3>
                    <div class="sql-table-description">${tableInfo.description}</div>
                </div>
                <table class="sql-table">
                    <thead>
                        <tr>
            `;

            // Add table headers
            tableInfo.columns.forEach(column => {
                html += `<th>${column}</th>`;
            });

            html += `
                        </tr>
                    </thead>
                    <tbody>
            `;

            // Add table rows
            tableInfo.rows.forEach(row => {
                html += '<tr>';
                row.forEach(cell => {
                    html += `<td>${cell}</td>`;
                });
                html += '</tr>';
            });

            html += `
                    </tbody>
                </table>
            `;

            content.innerHTML = html;
        }

        // Initialize with transactions table
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Projects widget
            new ProjectWidget('projects-widget');

            // Initialize with transactions table
            renderTable('transactions');

            // Handle table item clicks
            const tableItems = document.querySelectorAll('.sql-table-item');
            tableItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Remove active class from all items
                    tableItems.forEach(i => i.classList.remove('active'));
                    
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Render the selected table
                    renderTable(this.getAttribute('data-table'));
                });
            });
            
            // Handle data source clicks
            const dataSources = document.querySelectorAll('.source-item');
            const modalOverlay = document.getElementById('sql-modal-overlay');
            
            dataSources.forEach(source => {
                source.addEventListener('click', function() {
                    modalOverlay.classList.add('active');
                    
                    // Update SQL status based on which source was clicked
                    const sourceName = this.querySelector('span').textContent;
                    document.querySelector('.sql-status').textContent = `Connected to: ${sourceName} Database`;
                    
                    // If it's the Enterprise ERP, show transactions by default
                    if (this.id === 'erp-source') {
                        document.querySelector('.sql-table-item[data-table="transactions"]').click();
                    }
                    // If it's the Vendor Database, show vendors by default
                    else if (this.id === 'vendor-source') {
                        document.querySelector('.sql-table-item[data-table="vendors"]').click();
                    }
                    // If it's Market Intelligence, show contracts by default
                    else if (this.id === 'market-source') {
                        document.querySelector('.sql-table-item[data-table="contracts"]').click();
                    }
                });
            });
            
            // Close modal
            document.getElementById('sql-modal-close').addEventListener('click', function() {
                modalOverlay.classList.remove('active');
            });
            
            // Close modal when clicking outside modal content
            modalOverlay.addEventListener('click', function(event) {
                if (event.target === modalOverlay) {
                    modalOverlay.classList.remove('active');
                }
            });
            
            // Reset demo
            document.getElementById('reset-demo').addEventListener('click', function() {
                modalOverlay.classList.remove('active');
                // Add any other reset functionality here
            });
        });
    </script>
</body>
</html>
